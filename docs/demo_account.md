# 演示账号功能说明

## 功能概述

演示账号功能允许系统管理员设置一个或多个特殊的用户账号，这些账号只能执行GET请求（查看操作），无法执行POST、PUT、DELETE等修改数据的操作。这个功能特别适用于向客户展示系统功能时，防止客户误操作修改系统数据。

## 配置说明

### 配置项位置

演示账号相关配置位于 `config/config.yml` 文件的 `server` 节点下：

```yaml
server:
  # ... 其他配置项
  demoaccount:
    enabled: false    # 是否启用演示账号功能
    userids: []       # 演示账号的用户ID列表，例如：[1, 2, 3]
```

### 配置项说明

1. `enabled`: 布尔值，控制是否启用演示账号功能
   - `true`: 启用演示账号限制
   - `false`: 禁用演示账号限制

2. `userids`: 整数数组，指定演示账号的用户ID列表
   - 设置为具体的用户ID数组（如[1, 2, 3]）来启用该功能
   - 设置为空数组[]表示不启用

## 使用方法

### 1. 创建演示账号

首先在系统中创建一个或多个专门用于演示的用户账号，记录下这些用户的ID。

### 2. 配置演示账号

在 `config/config.yml` 文件中设置：

```yaml
server:
  demoaccount:
    enabled: true        # 启用演示账号功能
    userids: [2, 3, 5]   # 设置多个演示账号的用户ID
```

### 3. 重启服务

修改配置后需要重启服务使配置生效。

### 4. 测试功能

使用演示账号登录系统，尝试执行各种操作：
- GET请求（查看操作）：应该可以正常执行
- POST/PUT/DELETE请求（修改操作）：应该被拒绝，并返回403错误

## 功能特点

1. **安全性**: 只限制指定的演示账号，不影响其他正常用户
2. **灵活性**: 可以随时启用或禁用该功能，支持设置多个演示账号
3. **透明性**: 被拒绝的请求会返回明确的错误信息
4. **日志记录**: 被拒绝的操作会被记录在系统日志中

## 错误响应

当演示账号尝试执行非GET请求时，系统会返回以下JSON响应：

```json
{
  "code": 403,
  "message": "演示账号仅允许查看操作，禁止修改数据"
}
```

## 日志记录

所有被拒绝的演示账号操作都会在系统日志中记录，便于管理员监控：

```
WARN    middleware/demoaccount.go:xx  演示账号尝试执行非GET操作  {"userID": 2, "method": "POST", "path": "/api/users/add"}
```

## 注意事项

1. 演示账号功能只对通过JWT认证的受保护路由生效
2. 配置更改后需要重启服务才能生效
3. 建议为演示账号分配只读角色，以提供双重保护
4. 在生产环境中使用时，请确保演示账号没有敏感数据访问权限